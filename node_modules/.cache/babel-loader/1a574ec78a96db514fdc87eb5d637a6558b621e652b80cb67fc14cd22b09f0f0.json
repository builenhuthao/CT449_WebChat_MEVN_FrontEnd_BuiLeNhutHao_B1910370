{"ast":null,"code":"import { createElementVNode as _createElementVNode, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, renderList as _renderList, Fragment as _Fragment, normalizeStyle as _normalizeStyle, vModelText as _vModelText, withDirectives as _withDirectives } from \"vue\";\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = {\n  class: \"row clearfix\"\n};\nconst _hoisted_3 = {\n  class: \"col-lg-12\"\n};\nconst _hoisted_4 = {\n  key: 0,\n  class: \"card\"\n};\nconst _hoisted_5 = {\n  class: \"card-body\"\n};\nconst _hoisted_6 = /*#__PURE__*/_createElementVNode(\"h2\", {\n  class: \"text-center\",\n  style: {\n    \"margin-top\": \"20px\"\n  }\n}, \" This chat has been archived \", -1 /* HOISTED */);\nconst _hoisted_7 = {\n  class: \"row\",\n  style: {\n    \"margin-top\": \"100px\",\n    \"margin-bottom\": \"100px\"\n  }\n};\nconst _hoisted_8 = {\n  class: \"offset-md-4 col-md-4\"\n};\nconst _hoisted_9 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"form-group\",\n  style: {\n    \"margin-bottom\": \"10px\"\n  }\n}, [/*#__PURE__*/_createElementVNode(\"label\", null, \"Enter password\"), /*#__PURE__*/_createElementVNode(\"input\", {\n  type: \"password\",\n  name: \"password\",\n  class: \"form-control\",\n  required: \"\",\n  style: {\n    \"margin-top\": \"10px\"\n  }\n})], -1 /* HOISTED */);\nconst _hoisted_10 = /*#__PURE__*/_createElementVNode(\"input\", {\n  type: \"submit\",\n  class: \"btn btn-danger\",\n  value: \"Open chat\"\n}, null, -1 /* HOISTED */);\nconst _hoisted_11 = [_hoisted_9, _hoisted_10];\nconst _hoisted_12 = {\n  key: 1,\n  class: \"card chat-app\"\n};\nconst _hoisted_13 = {\n  class: \"chat\"\n};\nconst _hoisted_14 = {\n  class: \"chat-header clearfix\"\n};\nconst _hoisted_15 = {\n  class: \"row\"\n};\nconst _hoisted_16 = {\n  class: \"col-lg-6\"\n};\nconst _hoisted_17 = {\n  href: \"javascript:void(0);\",\n  \"data-toggle\": \"modal\",\n  \"data-target\": \"#view_info\"\n};\nconst _hoisted_18 = [\"src\"];\nconst _hoisted_19 = {\n  class: \"chat-about\"\n};\nconst _hoisted_20 = [\"textContent\"];\nconst _hoisted_21 = {\n  class: \"col-lg-6 hidden-sm text-right text-white\"\n};\nconst _hoisted_22 = [\"textContent\"];\nconst _hoisted_23 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"form-group\",\n  style: {\n    \"display\": \"flex\"\n  }\n}, [/*#__PURE__*/_createElementVNode(\"input\", {\n  type: \"search\",\n  name: \"search\",\n  autocomplete: \"off\"\n}), /*#__PURE__*/_createElementVNode(\"button\", {\n  type: \"submit\",\n  class: \"btn btn-link\"\n}, [/*#__PURE__*/_createElementVNode(\"i\", {\n  class: \"fa fa-search\"\n})])], -1 /* HOISTED */);\nconst _hoisted_24 = [_hoisted_23];\nconst _hoisted_25 = [\"textContent\"];\nconst _hoisted_26 = /*#__PURE__*/_createElementVNode(\"i\", {\n  class: \"fa fa-paperclip\"\n}, null, -1 /* HOISTED */);\nconst _hoisted_27 = [_hoisted_26];\nconst _hoisted_28 = {\n  class: \"chat-history\"\n};\nconst _hoisted_29 = {\n  class: \"m-b-0\"\n};\nconst _hoisted_30 = {\n  style: {\n    \"text-align\": \"center\"\n  }\n};\nconst _hoisted_31 = [\"onClick\", \"is-my-message\"];\nconst _hoisted_32 = [\"textContent\"];\nconst _hoisted_33 = [\"data-id\", \"textContent\"];\nconst _hoisted_34 = [\"textContent\"];\nconst _hoisted_35 = [\"src\"];\nconst _hoisted_36 = {\n  class: \"chat-message clearfix\"\n};\nconst _hoisted_37 = {\n  class: \"input-group mb-0\"\n};\nconst _hoisted_38 = {\n  class: \"input-group mb-3\"\n};\nconst _hoisted_39 = /*#__PURE__*/_createElementVNode(\"div\", {\n  id: \"emojis\"\n}, null, -1 /* HOISTED */);\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [$data.isArchive ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_hoisted_6, _createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"form\", {\n    onSubmit: _cache[0] || (_cache[0] = _withModifiers((...args) => $options.verifyArchivedPassword && $options.verifyArchivedPassword(...args), [\"prevent\"]))\n  }, _hoisted_11, 32 /* HYDRATE_EVENTS */)])])])])) : _createCommentVNode(\"v-if\", true), !$data.isArchive ? (_openBlock(), _createElementBlock(\"div\", _hoisted_12, [_createElementVNode(\"div\", _hoisted_13, [_createElementVNode(\"div\", _hoisted_14, [_createElementVNode(\"div\", _hoisted_15, [_createElementVNode(\"div\", _hoisted_16, [_createElementVNode(\"a\", _hoisted_17, [$data.receiver != null ? (_openBlock(), _createElementBlock(\"img\", {\n    key: 0,\n    src: $options.getChatPersonPicture($data.receiver),\n    alt: \"avatar\",\n    style: {\n      \"width\": \"50px\"\n    }\n  }, null, 8 /* PROPS */, _hoisted_18)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_19, [$data.receiver != null ? (_openBlock(), _createElementBlock(\"h6\", {\n    key: 0,\n    class: \"m-b-0 text-white\",\n    textContent: _toDisplayString($data.receiver.name),\n    style: {\n      \"margin-bottom\": \"0px\",\n      \"position\": \"relative\",\n      \"top\": \"10px\"\n    }\n  }, null, 8 /* PROPS */, _hoisted_20)) : _createCommentVNode(\"v-if\", true)])]), _createElementVNode(\"div\", _hoisted_21, [_createElementVNode(\"button\", {\n    type: \"button\",\n    class: \"btn btn-primary\",\n    style: {\n      \"margin-right\": \"10px\"\n    },\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.showBookmarkedMessages && $options.showBookmarkedMessages(...args)),\n    textContent: _toDisplayString($data.isShowingBookmarked ? 'All messages' : 'Bookmarked messages')\n  }, null, 8 /* PROPS */, _hoisted_22), _createElementVNode(\"form\", {\n    style: {\n      \"display\": \"inline-block\"\n    },\n    onSubmit: _cache[2] || (_cache[2] = _withModifiers((...args) => $options.doSearch && $options.doSearch(...args), [\"prevent\"]))\n  }, _hoisted_24, 32 /* HYDRATE_EVENTS */), $data.attachment != null ? (_openBlock(), _createElementBlock(\"span\", {\n    key: 0,\n    style: {\n      \"margin-right\": \"10px\",\n      \"position\": \"relative\",\n      \"top\": \"7px\"\n    },\n    textContent: _toDisplayString($data.attachment.name)\n  }, null, 8 /* PROPS */, _hoisted_25)) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"a\", {\n    href: \"javascript:void(0);\",\n    class: \"btn btn-outline-secondary pull-right text-white\",\n    onClick: _cache[3] || (_cache[3] = (...args) => $options.selectFile && $options.selectFile(...args))\n  }, _hoisted_27), _createElementVNode(\"input\", {\n    type: \"file\",\n    id: \"attachment\",\n    style: {\n      \"display\": \"none\"\n    },\n    onChange: _cache[4] || (_cache[4] = (...args) => $options.fileSelected && $options.fileSelected(...args))\n  }, null, 32 /* HYDRATE_EVENTS */)])])]), _createElementVNode(\"div\", _hoisted_28, [_createElementVNode(\"ul\", _hoisted_29, [_createElementVNode(\"li\", _hoisted_30, [$data.hasMoreMessages ? (_openBlock(), _createElementBlock(\"i\", {\n    key: 0,\n    class: _normalizeClass($data.btnLoadMoreClass + ' btnLoadMore'),\n    onClick: _cache[5] || (_cache[5] = (...args) => $options.loadMore && $options.loadMore(...args))\n  }, null, 2 /* CLASS */)) : _createCommentVNode(\"v-if\", true)]), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($options.messages, msg => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      class: \"clearfix\",\n      key: msg._id\n    }, [_createElementVNode(\"div\", {\n      class: \"more-options\",\n      onClick: $event => $options.showMoreOptions(msg),\n      \"is-my-message\": _ctx.user != null && _ctx.user.email == msg.sender.email,\n      style: _normalizeStyle(_ctx.user != null && _ctx.user.email == msg.sender.email ? {\n        float: 'right'\n      } : {\n        position: 'relative',\n        top: '15px'\n      })\n    }, null, 12 /* STYLE, PROPS */, _hoisted_31), _createElementVNode(\"div\", {\n      class: _normalizeClass('message ' + (_ctx.user != null && _ctx.user.email == msg.sender.email ? 'my-message float-right' : 'other-message'))\n    }, [_createElementVNode(\"p\", {\n      textContent: _toDisplayString(msg.message),\n      class: _normalizeClass(_ctx.user != null && _ctx.user.email == msg.sender.email ? 'text-right' : ''),\n      style: {\n        \"margin-bottom\": \"0px\"\n      }\n    }, null, 10 /* CLASS, PROPS */, _hoisted_32), msg.attachment != null ? (_openBlock(), _createElementBlock(\"a\", {\n      key: 0,\n      href: \"javascript:void(0)\",\n      \"data-id\": msg._id,\n      onClick: _cache[6] || (_cache[6] = _withModifiers((...args) => $options.downloadAttachment && $options.downloadAttachment(...args), [\"prevent\"])),\n      textContent: _toDisplayString(msg.attachment.displayName),\n      class: \"text-info\",\n      target: \"_blank\"\n    }, null, 8 /* PROPS */, _hoisted_33)) : _createCommentVNode(\"v-if\", true)], 2 /* CLASS */), _createElementVNode(\"div\", {\n      class: _normalizeClass('message-data ' + (_ctx.user != null && _ctx.user.email == msg.sender.email ? 'float-right' : ''))\n    }, [_createElementVNode(\"span\", {\n      class: \"message-data-time text-white\",\n      textContent: _toDisplayString($options.getMessageTime(msg.createdAt)),\n      style: {\n        \"margin-right\": \"10px\"\n      }\n    }, null, 8 /* PROPS */, _hoisted_34), _createElementVNode(\"img\", {\n      src: $options.getPicture(msg.sender),\n      alt: \"avatar\",\n      style: {\n        \"width\": \"100px\"\n      }\n    }, null, 8 /* PROPS */, _hoisted_35)], 2 /* CLASS */)]);\n  }), 128 /* KEYED_FRAGMENT */))])]), _createElementVNode(\"div\", _hoisted_36, [_createElementVNode(\"div\", _hoisted_37, [_createElementVNode(\"div\", _hoisted_38, [_withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    class: \"form-control send-message\",\n    placeholder: \"Enter text here...\",\n    \"onUpdate:modelValue\": _cache[7] || (_cache[7] = $event => $data.message = $event)\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.message]]), _createElementVNode(\"button\", {\n    class: \"btn btn-primary\",\n    onClick: _cache[8] || (_cache[8] = (...args) => $options.sendMessage && $options.sendMessage(...args)),\n    type: \"button\"\n  }, \" Send \")])]), _hoisted_39])])])) : _createCommentVNode(\"v-if\", true)])])]), _createCommentVNode(\" <a\\n    v-bind:href=\\\"base64Str\\\"\\n    ref=\\\"btnDownloadAttachment\\\"\\n    v-bind:download=\\\"downloadFileName\\\"\\n  ></a> \"), _createCommentVNode(\" <div id=\\\"contextMenu\\\" class=\\\"context-menu\\\" style=\\\"display: none\\\">\\n    <ul class=\\\"menu\\\">\\n      <li class=\\\"copy\\\">\\n        <a href=\\\"javascript:void(0)\\\" v-on:click=\\\"copyMessage\\\"\\n          ><i class=\\\"fa fa-copy\\\" aria-hidden=\\\"true\\\"></i> Copy</a\\n        >\\n      </li>\\n\\n      <li class=\\\"bookmark\\\">\\n        <a href=\\\"javascript:void(0)\\\" v-on:click=\\\"bookmarkMessage\\\"\\n          ><i class=\\\"fa fa-bookmark-o\\\" aria-hidden=\\\"true\\\"></i> Bookmark</a\\n        >\\n      </li>\\n    </ul>\\n  </div> \")], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */);\n}","map":{"version":3,"names":["class","_createElementVNode","style","type","name","required","value","_hoisted_9","_hoisted_10","href","autocomplete","_hoisted_23","_hoisted_26","id","_hoisted_1","_hoisted_2","_hoisted_3","$data","isArchive","_createElementBlock","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","onSubmit","_cache","_withModifiers","args","$options","verifyArchivedPassword","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","receiver","src","getChatPersonPicture","alt","_hoisted_19","_toDisplayString","_hoisted_21","onClick","showBookmarkedMessages","isShowingBookmarked","doSearch","attachment","selectFile","onChange","fileSelected","_hoisted_28","_hoisted_29","_hoisted_30","hasMoreMessages","_normalizeClass","btnLoadMoreClass","loadMore","_Fragment","_renderList","messages","msg","key","_id","$event","showMoreOptions","_ctx","user","email","sender","_normalizeStyle","message","downloadAttachment","displayName","target","getMessageTime","createdAt","getPicture","_hoisted_36","_hoisted_37","_hoisted_38","placeholder","sendMessage","_hoisted_39","_createCommentVNode"],"sources":["D:\\Laptrinh\\Phat_trien_ung_dung_web\\Projects\\Web-Chat\\CT449-WebChat-MEVN-FrontEnd-BuiLeNhutHao-B1910370\\src\\components\\ChatComponent.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <div class=\"row clearfix\">\n      <div class=\"col-lg-12\">\n        <div class=\"card\" v-if=\"isArchive\">\n          <div class=\"card-body\">\n            <h2 class=\"text-center\" style=\"margin-top: 20px\">\n              This chat has been archived\n            </h2>\n\n            <div class=\"row\" style=\"margin-top: 100px; margin-bottom: 100px\">\n              <div class=\"offset-md-4 col-md-4\">\n                <form v-on:submit.prevent=\"verifyArchivedPassword\">\n                  <div class=\"form-group\" style=\"margin-bottom: 10px\">\n                    <label>Enter password</label>\n                    <input\n                      type=\"password\"\n                      name=\"password\"\n                      class=\"form-control\"\n                      required\n                      style=\"margin-top: 10px\"\n                    />\n                  </div>\n\n                  <input\n                    type=\"submit\"\n                    class=\"btn btn-danger\"\n                    value=\"Open chat\"\n                  />\n                </form>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"card chat-app\" v-if=\"!isArchive\">\n          <div class=\"chat\">\n            <div class=\"chat-header clearfix\">\n              <div class=\"row\">\n                <div class=\"col-lg-6\">\n                  <a\n                    href=\"javascript:void(0);\"\n                    data-toggle=\"modal\"\n                    data-target=\"#view_info\"\n                  >\n                    <img\n                      v-if=\"receiver != null\"\n                      v-bind:src=\"getChatPersonPicture(receiver)\"\n                      alt=\"avatar\"\n                      style=\"width: 50px\"\n                    />\n                  </a>\n\n                  <div class=\"chat-about\">\n                    <h6\n                      class=\"m-b-0 text-white\"\n                      v-if=\"receiver != null\"\n                      v-text=\"receiver.name\"\n                      style=\"margin-bottom: 0px; position: relative; top: 10px\"\n                    ></h6>\n                  </div>\n                </div>\n\n                <div class=\"col-lg-6 hidden-sm text-right text-white\">\n                  <button\n                    type=\"button\"\n                    class=\"btn btn-primary\"\n                    style=\"margin-right: 10px\"\n                    v-on:click=\"showBookmarkedMessages\"\n                    v-text=\"\n                      isShowingBookmarked\n                        ? 'All messages'\n                        : 'Bookmarked messages'\n                    \"\n                  ></button>\n\n                  <form\n                    style=\"display: inline-block\"\n                    v-on:submit.prevent=\"doSearch\"\n                  >\n                    <div class=\"form-group\" style=\"display: flex\">\n                      <input type=\"search\" name=\"search\" autocomplete=\"off\" />\n                      <button type=\"submit\" class=\"btn btn-link\">\n                        <i class=\"fa fa-search\"></i>\n                      </button>\n                    </div>\n                  </form>\n\n                  <span\n                    v-if=\"attachment != null\"\n                    style=\"margin-right: 10px; position: relative; top: 7px\"\n                    v-text=\"attachment.name\"\n                  ></span>\n                  <a\n                    href=\"javascript:void(0);\"\n                    class=\"btn btn-outline-secondary pull-right text-white\"\n                    v-on:click=\"selectFile\"\n                    ><i class=\"fa fa-paperclip\"></i\n                  ></a>\n                  <input\n                    type=\"file\"\n                    id=\"attachment\"\n                    style=\"display: none\"\n                    v-on:change=\"fileSelected\"\n                  />\n                </div>\n              </div>\n            </div>\n\n            <div class=\"chat-history\">\n              <ul class=\"m-b-0\">\n                <li style=\"text-align: center\">\n                  <i\n                    v-bind:class=\"btnLoadMoreClass + ' btnLoadMore'\"\n                    v-on:click=\"loadMore\"\n                    v-if=\"hasMoreMessages\"\n                  ></i>\n                </li>\n\n                <li\n                  v-for=\"msg in messages\"\n                  class=\"clearfix\"\n                  v-bind:key=\"msg._id\"\n                >\n                  <div\n                    class=\"more-options\"\n                    v-on:click=\"showMoreOptions(msg)\"\n                    v-bind:is-my-message=\"\n                      user != null && user.email == msg.sender.email\n                    \"\n                    v-bind:style=\"\n                      user != null && user.email == msg.sender.email\n                        ? { float: 'right' }\n                        : { position: 'relative', top: '15px' }\n                    \"\n                  ></div>\n\n                  <div\n                    v-bind:class=\"\n                      'message ' +\n                      (user != null && user.email == msg.sender.email\n                        ? 'my-message float-right'\n                        : 'other-message')\n                    \"\n                  >\n                    <p\n                      v-text=\"msg.message\"\n                      v-bind:class=\"\n                        user != null && user.email == msg.sender.email\n                          ? 'text-right'\n                          : ''\n                      \"\n                      style=\"margin-bottom: 0px\"\n                    ></p>\n\n                    <template v-if=\"msg.attachment != null\">\n                      <a\n                        href=\"javascript:void(0)\"\n                        v-bind:data-id=\"msg._id\"\n                        v-on:click.prevent=\"downloadAttachment\"\n                        v-text=\"msg.attachment.displayName\"\n                        class=\"text-info\"\n                        target=\"_blank\"\n                      ></a>\n                    </template>\n                  </div>\n\n                  <div\n                    v-bind:class=\"\n                      'message-data ' +\n                      (user != null && user.email == msg.sender.email\n                        ? 'float-right'\n                        : '')\n                    \"\n                  >\n                    <span\n                      class=\"message-data-time text-white\"\n                      v-text=\"getMessageTime(msg.createdAt)\"\n                      style=\"margin-right: 10px\"\n                    ></span>\n                    <img\n                      v-bind:src=\"getPicture(msg.sender)\"\n                      alt=\"avatar\"\n                      style=\"width: 100px\"\n                    />\n                  </div>\n                </li>\n              </ul>\n            </div>\n\n            <div class=\"chat-message clearfix\">\n              <div class=\"input-group mb-0\">\n                <div class=\"input-group mb-3\">\n                  <input\n                    type=\"text\"\n                    class=\"form-control send-message\"\n                    placeholder=\"Enter text here...\"\n                    v-model=\"message\"\n                  />\n\n                  <button\n                    class=\"btn btn-primary\"\n                    v-on:click=\"sendMessage\"\n                    type=\"button\"\n                  >\n                    Send\n                  </button>\n                </div>\n              </div>\n\n              <div id=\"emojis\"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- <a\n    v-bind:href=\"base64Str\"\n    ref=\"btnDownloadAttachment\"\n    v-bind:download=\"downloadFileName\"\n  ></a> -->\n\n  <!-- <div id=\"contextMenu\" class=\"context-menu\" style=\"display: none\">\n    <ul class=\"menu\">\n      <li class=\"copy\">\n        <a href=\"javascript:void(0)\" v-on:click=\"copyMessage\"\n          ><i class=\"fa fa-copy\" aria-hidden=\"true\"></i> Copy</a\n        >\n      </li>\n\n      <li class=\"bookmark\">\n        <a href=\"javascript:void(0)\" v-on:click=\"bookmarkMessage\"\n          ><i class=\"fa fa-bookmark-o\" aria-hidden=\"true\"></i> Bookmark</a\n        >\n      </li>\n    </ul>\n  </div> -->\n</template>\n\n<script>\nimport \"../../public/assets/css/chat.css\";\nimport \"../../public/assets/emoji/emojis.css\";\nimport \"../../public/assets/emoji/DisMojiPicker.js\";\n\nimport axios from \"axios\";\nimport swal from \"sweetalert2\";\nimport store from \"../vuex/store\";\n\nexport default {\n  data() {\n    return {\n      attachment: null,\n      message: \"\",\n      email: this.$route.params.email,\n      page: 0,\n      receiver: null,\n      base64Str: \"\",\n      downloadFileName: \"\",\n      btnLoadMoreClass: \"fa fa-repeat\",\n      hasMoreMessages: true,\n      selectedMessageId: 0,\n      selectedMessageText: \"\",\n      isShowingBookmarked: false,\n      isArchive: false,\n      password: \"\",\n    };\n  },\n\n  computed: {\n    messages() {\n      return store.getters.getMessages;\n    },\n  },\n\n  methods: {\n    verifyArchivedPassword: async function () {\n      const self = this;\n      const form = event.target;\n      const formData = new FormData(form);\n      formData.append(\"email\", this.email);\n\n      const response = await axios.post(\n        this.$apiURL + \"/chat/verifyArchivedPassword\",\n        formData,\n        {\n          headers: this.$headers,\n        }\n      );\n\n      if (response.data.status == \"success\") {\n        this.isArchive = response.data.isArchive;\n        this.password = form.password.value;\n\n        if (this.isArchive) {\n          store.commit(\"setMessages\", []);\n          this.getData();\n\n          setTimeout(function () {\n            self.initializeEmoji();\n          }, 500);\n        }\n      } else {\n        swal.fire(\"Error\", response.data.message, \"error\");\n      }\n    },\n\n    showBookmarkedMessages: async function () {\n      store.commit(\"setMessages\", []);\n\n      if (this.isShowingBookmarked) {\n        this.page = 0;\n        this.getData();\n        this.isShowingBookmarked = false;\n      } else {\n        const formData = new FormData();\n        formData.append(\"email\", this.email);\n        formData.append(\"password\", this.password);\n\n        const response = await axios.post(\n          this.$apiURL + \"/chat/getBookmarked\",\n          formData,\n          {\n            headers: this.$headers,\n          }\n        );\n\n        if (response.data.status == \"success\") {\n          for (let a = 0; a < response.data.data.length; a++) {\n            store.commit(\"prependMessage\", response.data.data[a]);\n          }\n          this.attachEventListeners();\n        } else {\n          swal.fire(\"Error\", response.data.message, \"error\");\n        }\n\n        this.isShowingBookmarked = true;\n      }\n    },\n\n    copyMessage: function () {\n      navigator.clipboard.writeText(this.selectedMessageText);\n    },\n\n    bookmarkMessage: async function () {\n      const target = event.target;\n      const formData = new FormData();\n      formData.append(\"_id\", this.selectedMessageId);\n      formData.append(\"password\", this.password);\n\n      const response = await axios.post(\n        this.$apiURL + \"/chat/bookmark\",\n        formData,\n        {\n          headers: this.$headers,\n        }\n      );\n\n      if (response.data.status == \"success\") {\n        for (let a = 0; a < this.messages.length; a++) {\n          if (this.messages[a]._id == this.selectedMessageId) {\n            this.messages[a] = response.data.newMessage;\n            break;\n          }\n        }\n        store.commit(\"setMessages\", this.messages);\n      } else {\n        swal.fire(\"Error\", response.data.message, \"error\");\n      }\n    },\n\n    hideMoreOptions: function () {\n      document.getElementById(\"contextMenu\").style.display = \"none\";\n    },\n\n    showMoreOptions: function (msg) {\n      const isMyMessage = event.target.getAttribute(\"is-my-message\");\n      this.selectedMessageId = msg._id;\n      this.selectedMessageText = msg.message;\n\n      var menu = document.getElementById(\"contextMenu\");\n      menu.style.display = \"block\";\n      if (isMyMessage == \"true\") {\n        menu.style.left = event.pageX - 200 + \"px\";\n      } else {\n        menu.style.left = event.pageX + \"px\";\n      }\n      menu.style.top = event.pageY + \"px\";\n\n      document.querySelector(\".bookmark i\").className = \"fa fa-bookmark-o\";\n\n      if (msg.bookmarkBy) {\n        document.querySelector(\".bookmark i\").className = \"fa fa-bookmark\";\n      }\n    },\n\n    attachEventListeners: function () {\n      const self = this;\n\n      document.addEventListener(\"click\", function (e) {\n        const moreOptions = document.querySelectorAll(\".more-options\");\n        let isClickedMoreOptions = true;\n        for (let a = 0; a < moreOptions.length; a++) {\n          if (moreOptions[a].contains(e.target)) {\n            // Clicked in box\n            isClickedMoreOptions = true;\n            break;\n          } else {\n            // Clicked outside the box\n            isClickedMoreOptions = false;\n          }\n        }\n        if (!isClickedMoreOptions) {\n          self.hideMoreOptions();\n        }\n      });\n    },\n\n    getChatPersonPicture: function (user) {\n      if (typeof user.picture !== \"undefined\" && user.picture != \"\") {\n        return this.$apiURL + \"/\" + user.picture;\n      }\n      return \"../../assets/img/avatar2.png\";\n    },\n\n    getPicture: function (user) {\n      if (typeof user.picture !== \"undefined\") {\n        return this.$apiURL + \"/\" + user.picture;\n      }\n      return \"../../assets/img/avatar7.png\";\n    },\n\n    doSearch: async function () {\n      const form = event.target;\n      const formData = new FormData(form);\n      formData.append(\"email\", this.email);\n      formData.append(\"password\", this.password);\n\n      const response = await axios.post(\n        this.$apiURL + \"/chat/search\",\n        formData,\n        {\n          headers: this.$headers,\n        }\n      );\n\n      if (response.data.status == \"success\") {\n        store.commit(\"setMessages\", []);\n        for (let a = 0; a < response.data.data.length; a++) {\n          store.commit(\"prependMessage\", response.data.data[a]);\n        }\n        this.attachEventListeners();\n      } else {\n        swal.fire(\"Error\", response.data.message, \"error\");\n      }\n    },\n\n    downloadAttachment: async function () {\n      const anchor = event.target;\n      const id = anchor.getAttribute(\"data-id\");\n      const originalHtml = anchor.innerHTML;\n      anchor.innerHTML = \"Loading...\";\n\n      const formData = new FormData();\n      formData.append(\"messageId\", id);\n      formData.append(\"password\", this.password);\n\n      const response = await axios.post(\n        this.$apiURL + \"/chat/attachment\",\n        formData,\n        {\n          headers: this.$headers,\n        }\n      );\n\n      if (response.data.status == \"success\") {\n        this.base64Str = response.data.base64Str;\n        this.downloadFileName = response.data.fileName;\n\n        const btnDownloadAttachment = this.$refs[\"btnDownloadAttachment\"];\n        setTimeout(function () {\n          btnDownloadAttachment.click();\n          anchor.innerHTML = originalHtml;\n        }, 500);\n      } else {\n        swal.fire(\"Error\", response.data.message, \"error\");\n      }\n    },\n\n    fileSelected: function () {\n      const files = event.target.files;\n      if (files.length > 0) {\n        this.attachment = files[0];\n      }\n    },\n\n    selectFile: function () {\n      document.getElementById(\"attachment\").click();\n    },\n\n    getMessageTime: function (time) {\n      const dateObj = new Date(time);\n      let timeStr =\n        dateObj.getFullYear() +\n        \"-\" +\n        (dateObj.getMonth() + 1) +\n        \"-\" +\n        dateObj.getDate() +\n        \" \" +\n        dateObj.getHours() +\n        \":\" +\n        dateObj.getMinutes() +\n        \":\" +\n        dateObj.getSeconds();\n      return timeStr;\n    },\n\n    loadMore: function () {\n      this.btnLoadMoreClass = \"fa fa-spinner fa-spin\";\n      this.page++;\n      this.getData();\n    },\n\n    getData: async function () {\n      if (this.email == null) {\n        return;\n      }\n\n      const formData = new FormData();\n      formData.append(\"email\", this.email);\n      formData.append(\"page\", this.page);\n      formData.append(\"password\", this.password);\n\n      const response = await axios.post(\n        this.$apiURL + \"/chat/fetch\",\n        formData,\n        {\n          headers: this.$headers,\n        }\n      );\n\n      this.btnLoadMoreClass = \"fa fa-repeat\";\n\n      if (response.data.status == \"success\") {\n        for (let a = 0; a < response.data.messages.length; a++) {\n          store.commit(\"prependMessage\", response.data.messages[a]);\n        }\n        this.hasMoreMessages =\n          response.data.messages.length == 0 ? false : true;\n        this.receiver = response.data.receiver;\n        this.user = response.data.user;\n        this.isArchive = response.data.isArchive;\n        this.attachEventListeners();\n      } else {\n        swal.fire(\"Error\", response.data.message, \"error\");\n      }\n    },\n\n    sendMessage: async function () {\n      const formData = new FormData();\n      formData.append(\"email\", this.email);\n      formData.append(\"message\", this.message);\n      formData.append(\"password\", this.password);\n      if (this.attachment != null) {\n        formData.append(\"attachment\", this.attachment);\n      }\n\n      const response = await axios.post(this.$apiURL + \"/chat/send\", formData, {\n        headers: this.$headers,\n      });\n\n      if (response.data.status == \"success\") {\n        this.message = \"\";\n\n        this.attachment = null;\n        document.getElementById(\"attachment\").value = null;\n\n        store.commit(\"appendMessage\", response.data.messageObject);\n        this.attachEventListeners();\n      } else {\n        swal.fire(\"Error\", response.data.message, \"error\");\n      }\n    },\n\n    initializeEmoji: function () {\n      const self = this;\n      $(\"#emojis\").disMojiPicker();\n      twemoji.parse(document.body);\n      $(\"#emojis\").picker(function (emoji) {\n        self.message += emoji;\n      });\n    },\n  },\n\n  mounted() {\n    this.getData();\n    this.initializeEmoji();\n\n    /*document.addEventListener(\"click\", function () {\n\t\t\t\tself.hideMoreOptions()\n\t\t\t})\n\n       \t\tdocument.oncontextmenu = function () {\n       \t\t\tevent.preventDefault()\n\n\t            if (document.getElementById(\"contextMenu\").style.display == \"block\"){ \n\t                hideMenu(); \n\t            }else{ \n\t                var menu = document.getElementById(\"contextMenu\")      \n\t                menu.style.display = 'block'; \n\t                menu.style.left = event.pageX + \"px\"; \n\t                menu.style.top = event.pageY + \"px\"; \n\t            }\n       \t\t}*/\n  },\n\n  watch: {\n    $route: function (to, from) {\n      if (from.href.includes(\"/chat/\")) {\n        store.commit(\"setMessages\", []);\n      }\n    },\n  },\n};\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}